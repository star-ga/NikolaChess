# NikolaChess CI/CD Pipeline
# Copyright (c) 2026 STARGA, Inc. All rights reserved.

name: Build

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]
  release:
    types: [created]
  workflow_dispatch:

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Validate Project Structure
        run: |
          echo "Validating NikolaChess project structure..."

          # Check required files exist
          test -f "src/main.mind" || test -f "src/lib.mind" || echo "Note: Main source files will be added"
          test -f "runtime-build/nikola_auth.h" && echo "✓ Auth header present"
          test -f "Makefile" || test -f "build.mind" || echo "Note: Build config will be added"

          echo "✓ Project structure validated"

      - name: Check Runtime Auth Header
        run: |
          if [ -f "runtime-build/nikola_auth.h" ]; then
            echo "✓ nikola_auth.h found"
            head -20 runtime-build/nikola_auth.h
          else
            echo "⚠ nikola_auth.h not found"
          fi

  # Full build jobs - enabled when MIND compiler is available
  # Uncomment when mindlang.dev/install.sh is live
  #
  # build-linux:
  #   runs-on: ubuntu-latest
  #   steps:
  #     - uses: actions/checkout@v4
  #     - name: Install MIND Compiler
  #       run: |
  #         curl -sSL https://mindlang.dev/install.sh | bash
  #         echo "$HOME/.mind/bin" >> $GITHUB_PATH
  #     - name: Build
  #       run: mindc build --release
